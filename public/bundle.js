!function(){"use strict";const t=[i(460551),i(2033415),i(3084039),i(4656903),i(5707527),i(6758151),i(7806727),i(9381639),i(10432263),i(11484935),i(12535559),i(13059847),i(14634759),i(14636807),i(14636807),i(14114567),i(14116623),i(13594383),i(13596431),i(13598479),i(13600535),i(13076247),i(13078295),i(13080351),i(12558111),i(12558111),i(12560167),i(12560167),i(12562223),i(12037935),i(12039983),i(12039991),i(13619055),i(14671775),i(15724487),i(16777215)],e=1e3/27;class s{constructor(t){this.flames=[],this.width=320,this.height=200,this.ctx=t,this.imageData=this.ctx.getImageData(0,0,this.width,this.height),this._init(),this.lastUpdate=0,this.active=!0}posAt(t,e){return e*this.width+t}setValue(t,e,s){let i=this.posAt(t,e);this.flames[i]=s}valueAt(t,e){let s=this.posAt(t,e);return this.flames[s]}_init(){this._initCanvas(),this._initFlames()}_initFlames(){for(let t=0;t<this.width;t++)for(let e=1;e<this.height;e++)this.setValue(t,e,0);for(let t=0;t<this.width;t++)this.setValue(t,0,35)}_initCanvas(){for(let t=0;t<this.imageData.data.length;t++)this.imageData.data[t]=0,t%4==3&&(this.imageData.data[t]=255)}update(){let s=performance.now();if(!(s-this.lastUpdate<e)){performance.mark("start");for(let e=0;e<this.height;e++){const s=e*this.width,i=(e+1)*this.width,a=(this.height-e)*this.width;for(let e=0;e<this.width;e++){const h=3&Math.round(3*Math.random()),n=s+e,o=this.flames[n],r=o-(1&h),d=i+(e+h-1);this.flames[d]=r;const c=4*(a+e);if(o>0){const e=t[o];this.imageData.data[c]=e.r,this.imageData.data[c+1]=e.g,this.imageData.data[c+2]=e.b,this.imageData.data[c+3]=255}else this.imageData.data[c]=0,this.imageData.data[c+1]=0,this.imageData.data[c+2]=0,this.imageData.data[c+3]=255}}this.ctx.putImageData(this.imageData,0,0),this.lastUpdate=s,performance.mark("end"),performance.measure("elapsed","start","end")}}toggle(){if(this.active)for(let t=0;t<this.width;t++)this.setValue(t,0,0);else for(let t=0;t<this.width;t++)this.setValue(t,0,35);this.active=!this.active}}function i(t){return{r:t>>16&255,g:t>>8&255,b:255&t}}class a extends HTMLElement{constructor(){if(super(),this.active=!0,this.canvas=document.createElement("canvas"),this.offscreen=void 0!==this.canvas.transferControlToOffscreen,this.canvas.width=320,this.canvas.height=200,this.canvas.style.width="100%",this.canvas.style.height="100%",this.offscreen){const t=this.canvas.transferControlToOffscreen();t.width=320,t.height=200,this.worker=new Worker("doom-fire-worker.js"),this.worker.postMessage({msg:"init",canvas:t},[t])}else{let t=this.canvas.getContext("2d");this.animation=new s(t)}this.attachShadow({mode:"open"}).appendChild(this.canvas),this.addEventListener("click",()=>{this.toggle()})}connectedCallback(){this.offscreen?this.worker.postMessage({msg:"start"}):this.update()}toggle(){this.offscreen?this.worker.postMessage({msg:"toggle"}):this.animation.toggle()}update(){this.animation.update(),window.requestAnimationFrame(this.update.bind(this))}}customElements.get("doom-fire")||customElements.define("doom-fire",a),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js")})}();
//# sourceMappingURL=bundle.js.map
