!function(){"use strict";const t=[a(460551),a(2033415),a(3084039),a(4656903),a(5707527),a(6758151),a(7806727),a(9381639),a(10432263),a(11484935),a(12535559),a(13059847),a(14634759),a(14636807),a(14636807),a(14114567),a(14116623),a(13594383),a(13596431),a(13598479),a(13600535),a(13076247),a(13078295),a(13080351),a(12558111),a(12558111),a(12560167),a(12560167),a(12562223),a(12037935),a(12039983),a(12039991),a(13619055),a(14671775),a(15724487),a(16777215)];class i{constructor(t,i){this.canvas=i,this.parent=t,this.flames=[],this.width=320,this.height=168,this.ctx=i.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,this.width,this.height),this._init(),this.lastUpdate=0,this.active=!0,this.wind=0}posAt(t,i){return i*this.width+t}setValue(t,i,a){let s=this.posAt(t,i);this.flames[s]=a}valueAt(t,i){let a=this.posAt(t,i);return this.flames[a]}_init(){this._initCanvas(),this._initFlames()}_initFlames(){for(let t=0;t<this.width;t++)for(let i=1;i<this.height;i++)this.setValue(t,i,0);for(let t=0;t<this.width;t++)this.setValue(t,this.height-1,35)}_initCanvas(){for(let t=0;t<this.imageData.data.length;t++)this.imageData.data[t]=0,t%4==3&&(this.imageData.data[t]=255)}start(){requestAnimationFrame(this._update.bind(this))}_update(){let i=performance.now();if(i-this.lastUpdate<37.03703703703704)this.parent.requestAnimationFrame(this._update.bind(this));else{for(let i=0;i<this.height;i++){const a=i*this.width,s=(i-1)*this.width;for(let e=0;e<this.width;e++){const h=a+e,n=this.flames[h];if(i>0){const t=Math.floor(3*Math.random()),i=n>0?n-(1&t):0;let a=e+t-1+this.wind;a>=this.width?a-=this.width:a<0&&(a+=this.width);const h=s+a;this.flames[h]=i}const d=4*(a+e);if(n>0){const i=t[n];this.imageData.data[d]=i.r,this.imageData.data[d+1]=i.g,this.imageData.data[d+2]=i.b,this.imageData.data[d+3]=255}else this.imageData.data[d]=0,this.imageData.data[d+1]=0,this.imageData.data[d+2]=0,this.imageData.data[d+3]=255}}this.ctx.putImageData(this.imageData,0,0),this.lastUpdate=i,this.parent.requestAnimationFrame(this._update.bind(this))}}toggle(){if(this.active)for(let t=0;t<this.width;t++)this.setValue(t,this.height-1,0);else for(let t=0;t<this.width;t++)this.setValue(t,this.height-1,35);this.active=!this.active}setWind(t){this.wind=t}}function a(t){return{r:t>>16&255,g:t>>8&255,b:255&t}}let s;self.onmessage=function(t){"init"===t.data.msg&&(s=new i(self,t.data.canvas)),"start"===t.data.msg&&s.start(),"toggle"===t.data.msg&&s.toggle(),"wind"===t.data.msg&&s.setWind(t.data.amount)}}();
//# sourceMappingURL=doom-fire-worker.js.map
