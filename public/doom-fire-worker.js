!function(){"use strict";const t=[s(460551),s(2033415),s(3084039),s(4656903),s(5707527),s(6758151),s(7806727),s(9381639),s(10432263),s(11484935),s(12535559),s(13059847),s(14634759),s(14636807),s(14636807),s(14114567),s(14116623),s(13594383),s(13596431),s(13598479),s(13600535),s(13076247),s(13078295),s(13080351),s(12558111),s(12558111),s(12560167),s(12560167),s(12562223),s(12037935),s(12039983),s(12039991),s(13619055),s(14671775),s(15724487),s(16777215)],i=1e3/27;class a{constructor(t,i){this.canvas=i,this.parent=t,this.flames=[],this.width=320,this.height=168,this.ctx=i.getContext("2d"),this.imageData=this.ctx.getImageData(0,0,this.width,this.height),this._init(),this.lastUpdate=0,this.active=!0,this.wind=0}posAt(t,i){return i*this.width+t}setValue(t,i,a){let s=this.posAt(t,i);this.flames[s]=a}valueAt(t,i){let a=this.posAt(t,i);return this.flames[a]}_init(){this._initCanvas(),this._initFlames()}_initFlames(){for(let t=0;t<this.width;t++)for(let i=1;i<this.height;i++)this.setValue(t,i,0);for(let t=0;t<this.width;t++)this.setValue(t,this.height-1,35)}_initCanvas(){for(let t=0;t<this.imageData.data.length;t++)this.imageData.data[t]=0,t%4==3&&(this.imageData.data[t]=255)}start(){requestAnimationFrame(this._update.bind(this))}_update(){let a=performance.now();if(a-this.lastUpdate<i)this.parent.requestAnimationFrame(this._update.bind(this));else{for(let i=0;i<this.height;i++){const a=i*this.width,s=(i-1)*this.width;for(let e=0;e<this.width;e++){const h=a+e,n=this.flames[h];if(i>0){const t=Math.floor(3*Math.random()),i=n>0?n-(1&t):0;let a=e+t-1+this.wind;a>=this.width?a-=this.width:a<0&&(a+=this.width);const h=s+a;this.flames[h]=i}const d=4*(a+e);if(n>0){const i=t[n];this.imageData.data[d]=i.r,this.imageData.data[d+1]=i.g,this.imageData.data[d+2]=i.b,this.imageData.data[d+3]=255}else this.imageData.data[d]=0,this.imageData.data[d+1]=0,this.imageData.data[d+2]=0,this.imageData.data[d+3]=255}}this.ctx.putImageData(this.imageData,0,0),this.lastUpdate=a,this.parent.requestAnimationFrame(this._update.bind(this))}}toggle(){if(this.active)for(let t=0;t<this.width;t++)this.setValue(t,this.height-1,0);else for(let t=0;t<this.width;t++)this.setValue(t,this.height-1,35);this.active=!this.active}setWind(t){this.wind=t}}function s(t){return{r:t>>16&255,g:t>>8&255,b:255&t}}let e;self.onmessage=function(t){"init"===t.data.msg&&(e=new a(self,t.data.canvas)),"start"===t.data.msg&&e.start(),"toggle"===t.data.msg&&e.toggle(),"wind"===t.data.msg&&e.setWind(t.data.amount)}}();
//# sourceMappingURL=doom-fire-worker.js.map
