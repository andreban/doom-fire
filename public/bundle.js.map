{"version":3,"file":"bundle.js","sources":["../src/doom-fire-animation.mjs","../src/doom-fire.mjs","../src/wake-lock.mjs","../src/trusted-web-activity.mjs","../src/main.js","../src/service-worker.mjs","../src/fullscreen.mjs"],"sourcesContent":["/*\n * Copyright 2021 Google Inc. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nconst HTML_COLOR_SCALE = [\n  parseColor(0x070707), parseColor(0x1f0707), parseColor(0x2f0f07),\n  parseColor(0x470f07), parseColor(0x571707), parseColor(0x671f07),\n  parseColor(0x771f07), parseColor(0x8f2707), parseColor(0x9f2f07),\n  parseColor(0xaf3f07), parseColor(0xbf4707), parseColor(0xc74707),\n  parseColor(0xDF4F07), parseColor(0xDF5707), parseColor(0xDF5707),\n  parseColor(0xD75F07), parseColor(0xD7670F), parseColor(0xcf6f0f),\n  parseColor(0xcf770f), parseColor(0xcf7f0f), parseColor(0xCF8717),\n  parseColor(0xC78717), parseColor(0xC78F17), parseColor(0xC7971F),\n  parseColor(0xBF9F1F), parseColor(0xBF9F1F), parseColor(0xBFA727),\n  parseColor(0xBFA727), parseColor(0xBFAF2F), parseColor(0xB7AF2F),\n  parseColor(0xB7B72F), parseColor(0xB7B737), parseColor(0xCFCF6F),\n  parseColor(0xDFDF9F), parseColor(0xEFEFC7), parseColor(0xFFFFFF)   \n];\nconst UPDATE_INTERVAL = 1000 / 27; // DoomFire runs at 27FPS.\nexport default class DoomFireAnimation {\n  constructor(parent, canvas) {\n    this.canvas = canvas;\n    this.parent = parent;\n    this.flames = [];\n    this.width = 320;\n    this.height = 168;\n    this.ctx = canvas.getContext('2d');\n    this.imageData = this.ctx.getImageData(0, 0, this.width, this.height);    \n    this._init();\n    this.lastUpdate = 0;\n    this.active = true;\n    this.wind = 0;\n  }\n\n  posAt(x, y) {\n    return y * this.width + x;\n  }\n    \n  setValue(x, y, value) {\n    let pos = this.posAt(x, y);\n    this.flames[pos] = value; \n  }\n\n  valueAt(x, y) {\n    let pos = this.posAt(x, y);\n    return this.flames[pos];\n  }  \n\n  _init() {\n    this._initCanvas();\n    this._initFlames();\n  }\n\n  _initFlames() {\n    // Initialise the flames.\n    for (let x = 0; x < this.width; x++) {\n      for (let y = 1; y < this.height; y++) {\n        this.setValue(x, y, 0);\n      }\n    }\n\n    for (let x = 0; x < this.width; x++) {\n      this.setValue(x, this.height - 1, 35);      \n    }\n  }\n\n  _initCanvas() {\n    // Initialise the canvas with black.\n    for (let i = 0; i < this.imageData.data.length; i++) {\n      this.imageData.data[i] = 0;\n      if (i % 4 == 3) this.imageData.data[i] = 255;\n    }\n  }\n\n  start() {\n    requestAnimationFrame(this._update.bind(this));\n  }\n\n  _update() {\n    let now = performance.now();\n    if (now - this.lastUpdate < UPDATE_INTERVAL) {\n      this.parent.requestAnimationFrame(this._update.bind(this));\n      return;\n    }\n\n    for (let srcY = 0; srcY < this.height; srcY++) {\n      const srcRow = srcY * this.width;\n      const dstRow = (srcY - 1) * this.width;\n      for (let srcX = 0; srcX < this.width; srcX++) {        \n        const srcIndex = srcRow + srcX;\n        const srcColor = this.flames[srcIndex];\n\n        if (srcY > 0) {\n          const rand = Math.floor(Math.random() * 3.0);\n          const dstColor = srcColor > 0 ? srcColor - (rand & 1) : 0;\n  \n          let dstX = srcX + rand - 1 + this.wind;\n          if (dstX >= this.width) {\n            dstX = dstX - this.width;\n          } else if (dstX < 0) {\n            dstX = dstX + this.width;\n          }\n            \n          const index = dstRow + dstX;\n          this.flames[index] = dstColor; \n        }\n  \n        const pos = (srcRow + srcX) * 4;  \n        if (srcColor > 0) {\n          const color = HTML_COLOR_SCALE[srcColor];\n          this.imageData.data[pos] = color.r;\n          this.imageData.data[pos + 1] = color.g;\n          this.imageData.data[pos + 2] = color.b;\n          this.imageData.data[pos + 3] = 255;\n        } else {\n          this.imageData.data[pos] = 0;\n          this.imageData.data[pos + 1] = 0;\n          this.imageData.data[pos + 2] = 0;\n          this.imageData.data[pos + 3] = 255;        \n        }\n      }\n    }\n    this.ctx.putImageData(this.imageData, 0, 0);  \n    this.lastUpdate = now;\n    this.parent.requestAnimationFrame(this._update.bind(this));\n  }\n\n  toggle() {\n    if (this.active) {\n      for (let x = 0; x < this.width; x++) {\n        this.setValue(x, this.height - 1, 0);      \n      }    \n    } else {\n      for (let x = 0; x < this.width; x++) {\n        this.setValue(x, this.height - 1, 35);      \n      }    \n    }\n    this.active = !this.active;    \n  }\n\n  setWind(amount) {\n    this.wind = amount;\n  }\n}\n\nfunction parseColor(color) {\n  const b = color & 0xFF;\n  const g = color >> 8 & 0xFF;\n  const r = color >> 16 & 0xFF;\n  return {r, g, b}\n}\n","/*\n * Copyright 2021 Google Inc. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nimport DoomFireAnimation from './doom-fire-animation.mjs';\n\nexport default class DoomFire extends HTMLElement {\n  constructor() {\n    super();\n    this.active = true;\n\n    // Create a Canvas to draw the flames.\n    this.canvas = document.createElement('canvas');\n    this.offscreen = 'OffscreenCanvas' in window;\n\n    // Set size.\n    this.canvas.width = 320;\n    this.canvas.height = 168;\n\n    // Make it fill the whole element.\n    this.canvas.style.width = '100%';\n    this.canvas.style.height = '100%';\n\n    // Make the rendering pixelated, for a retro effect,\n    this.canvas.style.imageRendering = 'pixelated';\n\n    if (this.offscreen) {\n      console.log('Rendering with Offscreen Canvas.');\n      const offscreenCanvas = this.canvas.transferControlToOffscreen();\n      offscreenCanvas.width = 320;\n      offscreenCanvas.height = 168;      \n      this.worker = new Worker('doom-fire-worker.js');\n      this.worker.postMessage({msg: 'init', canvas: offscreenCanvas}, [offscreenCanvas]);\n    } else {\n      console.log('Rendering with regular Canvas.');\n      this.animation = new DoomFireAnimation(window, this.canvas);\n    }\n\n    const shadowRoot = this.attachShadow({mode: 'open'});\n    shadowRoot.appendChild(this.canvas);\n     \n    this.addEventListener('click', () => {\n      this.toggle();\n    });\n  }\n\n  connectedCallback() {\n    if (this.offscreen) {\n      this.worker.postMessage({msg: 'start'});\n    } else {\n      this.animation.start();\n    }\n  }  \n\n  toggle() {\n    if (this.offscreen) {\n      this.worker.postMessage({msg: 'toggle'});      \n    } else {\n      this.animation.toggle();\n    }    \n  }\n\n  setWind(amount) {\n    if (this.offscreen) {\n      this.worker.postMessage({msg: 'wind', amount: amount});      \n    } else {\n      this.animation.setWind(amount);\n    }\n  }\n}\n\nif (!customElements.get('doom-fire')) {\n  customElements.define('doom-fire', DoomFire);\n}\n","/*\n * Copyright 2021 Google Inc. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nexport class WakeLockController {\n  constructor(keepAwakeButton) {\n    this.wakeLock = null;\n    this.keepAwakeButton = keepAwakeButton;\n  }\n\n  async requestWakeLock() {\n    try {\n      this.wakeLock = await navigator.wakeLock.request('screen');\n      this.wakeLock.addEventListener('release', () => {\n        this.keepAwakeButton.checked = false;\n        console.log('Screen Wake Lock was released.');\n      }, {once: true});\n      console.log('Screen Wake Lock is active.');\n      this.keepAwakeButton.checked = true;\n    } catch(err) {\n      console.error(`${err.name}, ${err.message}`);\n    }\n  }\n\n  async releaseWakeLock() {\n    try {\n      this.wakeLock.release();\n      this.wakeLock = null;\n    } catch(err) {\n      console.error(`${err.name}, ${err.message}`);\n    }\n  }\n\n  static setup(keepAwakeButton) {\n    if (!'wakeLock' in navigator) {\n      console.log('Wake Lock API is not supported ðŸ˜ž');\n      return;\n    }\n\n    console.log('Wake Lock API supported ðŸŽ‰')\n    keepAwakeButton.removeAttribute('disabled');\n    keepAwakeButton.classList.remove('hidden');\n    const wakeLockController = new WakeLockController(keepAwakeButton);\n    keepAwakeButton.addEventListener('click', async () => {\n      if (wakeLockController.wakeLock) {\n        await wakeLockController.releaseWakeLock();\n      } else {\n        await wakeLockController.requestWakeLock();\n      }\n    });\n\n    const handleVisibilityChange = () => {\n      if (wakeLockController.wakeLock !== null && document.visibilityState === 'visible') {\n        wakeLockController.requestWakeLock();\n      }\n    };\n    \n    document.addEventListener('visibilitychange', handleVisibilityChange); \n  }\n}\n","/*\n * Copyright 2021 Google Inc. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nconst TWA_PROTOCOL = 'android-app:';\nconst KEY_IS_TWA = 'isTrustedWebActivity';\n\nexport function isTrustedWebActivity(packageName) {\n  const sessionStorageStatus = sessionStorage.getItem(KEY_IS_TWA);\n  if (sessionStorageStatus === 'true') {\n    return true;\n  }\n\n  const referrer = document.referrer.trim();\n  if (referrer.length === 0) {\n    return false;\n  }\n\n  console.log('Referrer: ', referrer);\n  const referrerUrl = new URL(referrer);\n  if (referrerUrl.protocol === TWA_PROTOCOL\n      && referrerUrl.hostname === packageName) {\n        sessionStorage.setItem(KEY_IS_TWA, 'true');\n    return true;\n  }\n\n  return false;\n}\n","/*\n * Copyright 2021 Google Inc. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nimport './doom-fire.mjs';\nimport {WakeLockController} from './wake-lock.mjs';\nimport {FullscreenController} from './fullscreen.mjs';\nimport {isTrustedWebActivity} from './trusted-web-activity.mjs';\nimport './service-worker.mjs';\n\nlet doomFire;\nlet wind = 0;\nconst audioElement = document.querySelector('#audio');\nconst fullscreenButton = document.querySelector('#fullscreen');\nFullscreenController.setup(fullscreenButton, document.body);\n\nconst keepAwakeButton = document.querySelector('#keep-awake');\nWakeLockController.setup(keepAwakeButton);\n\nconst soundButton = document.querySelector('#sound');\nsoundButton.addEventListener('click', () => {\n  if (soundButton.checked) {\n    console.log('pause');\n    audioElement.pause();\n  } else {\n    console.log('play');\n    audioElement.play();\n  }\n});\n\nconst installButton = document.querySelector('#install');\n\nif (isTrustedWebActivity('com.doom_fire.twa')) {\n  console.log('Running in Trusted Web Activity Mode!');\n  fullscreenButton.classList.add('hidden');\n}\n\ndocument.addEventListener('keydown', (e) => {\n  if (doomFire) {\n    if (e.key === 'ArrowLeft') {\n      wind--;\n      doomFire.setWind(wind);\n    } else if (e.key == 'ArrowRight') {\n      wind++;\n      doomFire.setWind(wind);\n    }\n  }\n});\n\nif (window.DeviceOrientationEvent) {\n  window.addEventListener('deviceorientation', (e) => {\n    const orientation = (screen.orientation || {}).type || screen.mozOrientation || screen.msOrientation;\n    switch (orientation) {\n      case 'portrait-primary':\n        wind = -Math.round(e.gamma / 10);\n        break;\n      case 'portrait-secondary':\n        wind = Math.round(e.gamma / 10);\n        break;\n      case 'landscape-primary':\n        wind = -Math.round(e.beta / 10);\n        break;\n      case 'landscape-secondary':\n        wind = Math.round(e.beta / 10);\n        break;\n    }\n    doomFire.setWind(wind);\n  });\n}\n\nlet deferredPrompt;\nwindow.addEventListener('beforeinstallprompt', (e) => {\n  e.preventDefault();\n  deferredPrompt = e;\n  installButton.classList.remove('hidden');\n  console.log(`'beforeinstallprompt' event was fired.`);\n});\n\ninstallButton.addEventListener('click', async () => {\n  if (deferredPrompt) {\n    deferredPrompt.prompt();\n    const {outcome} = await deferredPrompt.userChoice;\n    console.log(`User response to the install prompt: ${outcome}`);\n  }\n});\n\ncustomElements.whenDefined('doom-fire')\n  .then(() => {\n    doomFire = document.querySelector('doom-fire');\n  });\n","/*\n * Copyright 2021 Google Inc. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nif ('serviceWorker' in navigator) {\n  // Use the window load event to keep the page load performant\n  window.addEventListener('load', () => {\n    navigator.serviceWorker.register('/sw.js');\n  });\n}","/*\n * Copyright 2021 Google Inc. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nexport class FullscreenController {\n  static setup(buttonElement, fullscreenElement) {\n    if (!fullscreenElement.requestFullscreen) {\n      console.log('Fullscreen API is not supported ðŸ˜ž');\n      return;\n    }\n    console.log('Fullscreen API supported ðŸŽ‰')\n\n    buttonElement.classList.remove('hidden');\n    buttonElement.addEventListener('click', async () => {\n      try {\n        if (document.fullscreenElement) {\n          console.log('Exiting fullscreen.');\n          await document.exitFullscreen();\n        } else {\n          console.log('Entering fullscreen.');\n          await fullscreenElement.requestFullscreen();\n        }\n      } catch (err) {\n        console.error(`${err.name}, ${err.message}`);    \n      }\n    });\n    \n    fullscreenElement.addEventListener('fullscreenchange', (e) => {\n      if (document.fullscreenElement) {\n        buttonElement.checked = true;\n      } else {\n        buttonElement.checked = false;\n      }\n    });\n  }\n}\n"],"names":["HTML_COLOR_SCALE","parseColor","DoomFireAnimation","constructor","parent","canvas","this","flames","width","height","ctx","getContext","imageData","getImageData","_init","lastUpdate","active","wind","posAt","x","y","setValue","value","pos","valueAt","_initCanvas","_initFlames","i","data","length","start","requestAnimationFrame","_update","bind","now","performance","srcY","srcRow","dstRow","srcX","srcIndex","srcColor","rand","Math","floor","random","dstColor","dstX","index","color","r","g","b","putImageData","toggle","setWind","amount","DoomFire","HTMLElement","super","document","createElement","offscreen","window","style","imageRendering","console","log","offscreenCanvas","transferControlToOffscreen","worker","Worker","postMessage","msg","animation","attachShadow","mode","appendChild","addEventListener","connectedCallback","customElements","get","define","WakeLockController","keepAwakeButton","wakeLock","async","navigator","request","checked","once","err","error","name","message","release","static","removeAttribute","classList","remove","wakeLockController","releaseWakeLock","requestWakeLock","visibilityState","KEY_IS_TWA","doomFire","serviceWorker","register","audioElement","querySelector","fullscreenButton","buttonElement","fullscreenElement","requestFullscreen","exitFullscreen","e","setup","body","soundButton","pause","play","installButton","deferredPrompt","packageName","sessionStorage","getItem","referrer","trim","referrerUrl","URL","protocol","hostname","setItem","isTrustedWebActivity","add","key","DeviceOrientationEvent","screen","orientation","type","mozOrientation","msOrientation","round","gamma","beta","preventDefault","prompt","outcome","userChoice","whenDefined","then"],"mappings":"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"}